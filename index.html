<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="google-site-verification" content="We4cS1h0IumMJjPPUa-q5_PDG5BHKCm8e5htMVa6m0w" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="洞香春" type="application/atom+xml" />






<meta name="description" content="前端，后端，炒菜，摄影，读书，收集工具">
<meta name="keywords" content="王端端, 洞香春, wellClient">
<meta property="og:type" content="website">
<meta property="og:title" content="洞香春">
<meta property="og:url" content="https://wdd.js.org/index.html">
<meta property="og:site_name" content="洞香春">
<meta property="og:description" content="前端，后端，炒菜，摄影，读书，收集工具">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="洞香春">
<meta name="twitter:description" content="前端，后端，炒菜，摄影，读书，收集工具">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://wdd.js.org/"/>





  <title>洞香春</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?32b66b12a233c7f47949966dc2e2cd97";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">洞香春</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">洞香春以名士荟萃、谈论国事、交流思想而著称于当时列国 --《大秦帝国》</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/few-simple-rules-for-good-coding-my-15-years-experience.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/few-simple-rules-for-good-coding-my-15-years-experience.html" itemprop="url">【译】13简单的优秀编码规则（从我15年的经验）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T14:03:12+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,626 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="https://hackernoon.com/few-simple-rules-for-good-coding-my-15-years-experience-96cb29d4acd9#.ddzpjb80c" target="_blank" rel="noopener">https://hackernoon.com/few-simple-rules-for-good-coding-my-15-years-experience-96cb29d4acd9#.ddzpjb80c</a></p>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207140343_0UaL3X_Screenshot.jpeg" alt=""></p>
<p>嗨，我的工作作为一个程序员超过15年，并使用许多不同的语言，范例，框架和其他狗屎。我想和大家分享我写好代码的规则。</p>
<h1 id="优化VS可读性-去他妈的优化"><a href="#优化VS可读性-去他妈的优化" class="headerlink" title="优化VS可读性 去他妈的优化"></a>优化VS可读性 去他妈的优化</h1><p>始终编​​写易于阅读且对开发人员可理解的代码。因为在硬可读代码上花费的时间和资源将远远高于从优化中获得的。<br>如果你需要进行优化，那么使它像DI的独立模块，具有100％的测试覆盖率，并且不会被触及至少一年。</p>
<h1 id="架构第一"><a href="#架构第一" class="headerlink" title="架构第一"></a>架构第一</h1><p>我看到很多人说“我们需要快速做事，我们没有时间做架构”。其中约99％的人因为这样的想法而遇到了大问题。<br>编写代码而不考虑其架构是没有用的，就像没有实现它们的计划一样，梦想你的愿望。<br>在编写代码的第一行之前，你应该明白它将要做什么，它将如何使用，模块，服务如何相互工作，它将有什么结构，如何进行测试和调试，以及如何更新。</p>
<h1 id="测试覆盖率"><a href="#测试覆盖率" class="headerlink" title="测试覆盖率"></a>测试覆盖率</h1><p>测试是好事，但他们并不总是负担得起，对项目有意义。</p>
<p>当你需要测试：</p>
<ul>
<li>当你编写模块时，微服务将不会被触及至少一个月。</li>
<li>当你编写开源代码。</li>
<li>当你编写涉及金融渠道的核心代码或代码。</li>
<li>当您有代码更新的同时更新测试的资源。</li>
</ul>
<p>当你不需要测试时：</p>
<ul>
<li>当你是一个创业。</li>
<li>当你有小团队和代码更改是快速。</li>
<li>当你编写的脚本，可以简单地通过他们的输出手动测试。</li>
</ul>
<p>记住，<code>带有严格测试的代码可能比没有测试的代码更有害</code>。</p>
<h1 id="保持简单，极度简单"><a href="#保持简单，极度简单" class="headerlink" title="保持简单，极度简单"></a>保持简单，极度简单</h1><p>不要编写复杂的代码。更多更简单，那么更少的错误它可能有和更少的时间来调试它们。代码应该做的只是它需要没有非常多的抽象和其他OOP shit（尤其是涉及java开发人员）+ 20％的东西可能需要在将来以简单的方式更新它。</p>
<h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><p>出现注释说明你的代码不够好。好的代码应该是可以理解的，没有一行注释。但是如何为新开发人员节省时间？ - 编写简单的内联文档描述什么和如何方法工作。这将节省很多时间来理解，甚至更多 - 它将给人们更多的机会来提出更好的实施这种方法。并且它将是全球代码文档的良好开端。</p>
<h1 id="硬耦合VS较小耦合"><a href="#硬耦合VS较小耦合" class="headerlink" title="硬耦合VS较小耦合"></a>硬耦合VS较小耦合</h1><p>始终尝试使用微服务架构。单片软件可以比微服务软件运行得更快，但只能在一个服务器的上下文中运行。<br>微服务使您可以不仅在许多服务器上，而且有时甚至在一台机器上（我的意思是过程分发）高效地分发您的软件。</p>
<h1 id="代码审查"><a href="#代码审查" class="headerlink" title="代码审查"></a>代码审查</h1><p>代码审查可以是好的，也以是坏的。<br>您可以组织代码审查，只有当您有开发人员了解95％的代码，谁可以监控所有更新，而不浪费很多时间。在其他情况下，这将是只是耗时，每个人都会讨厌这个。</p>
<p>在这部分有很多问题，所以更深入地描述这一点。</p>
<p>许多人认为代码审查是一个很好的方式教新手，或者工作在不同部分的代码的队友。但是代码审查的主要目标是保持代码质量，而不是教学。让我们想象你的团队制作代码用于控制核反应堆或太空火箭发动机的冷却系统。你在非常硬的逻辑中犯了巨大的错误，然后你给这个代码审查新的家伙。你怎么认为会发生意外的风险？ - 我的练习率超过70％。</p>
<p>良好的团队是每个人都有自己的角色，负责确切的工作。如果有人想要理解另一段代码，那么他去一个负责任去问他。你不可能知道一切，更好的优秀的理解小块代码而不是理解所有。</p>
<h1 id="重构没啥用"><a href="#重构没啥用" class="headerlink" title="重构没啥用"></a>重构没啥用</h1><p>在我的职业生涯中，我听到很多次“不要担心，我们以后会重构它”。在未来，这会导致大的技术债务或从头开始删除所有的代码和写作。</p>
<p>所以，不要得到一个债务，除非你有钱从头开发你的软件几次。</p>
<h1 id="当你累了或在一个坏的心情不要写代码。"><a href="#当你累了或在一个坏的心情不要写代码。" class="headerlink" title="当你累了或在一个坏的心情不要写代码。"></a>当你累了或在一个坏的心情不要写代码。</h1><p>当开发人员厌倦时，他们正在制造2到5倍或者更多的bug。所以工作更多是非常糟糕的做法。这就是为什么越来越多的国家思考6小时工作日，其中一些已经有了。精神工作不同于使用你的二头肌。</p>
<h1 id="不要一次写全部-使开发迭代"><a href="#不要一次写全部-使开发迭代" class="headerlink" title="不要一次写全部 - 使开发迭代"></a>不要一次写全部 - 使开发迭代</h1><p>在编写代码分析和预测之前，您的客户/客户真正需要什么，然后选择您可以在短期内以高质量开发的MVF（最有价值的功能）。使用这样的迭代来部署质量更新，而不是腰部时间和资源对不合理的愿望和牺牲与质量。</p>
<h1 id="自动化VS手动"><a href="#自动化VS手动" class="headerlink" title="自动化VS手动"></a>自动化VS手动</h1><p>自动化是长期的100％成功。所以如果你有资源自动化的东西，现在应该做。你可能认为“只需要5分钟，为什么我应该自动化？但让我计算这个。例如，它是5个开发人员的日常任务。 5分钟<em> 5天</em> 21天* 12个月= 6 300分钟= 105小时= 13.125天〜5250 $。<br>如果你有40 000名员工，这将需要多少费用？</p>
<h1 id="出去浪，学习新爱好"><a href="#出去浪，学习新爱好" class="headerlink" title="出去浪，学习新爱好"></a>出去浪，学习新爱好</h1><p>差异化工作可以增加心智能力，并提供新想法。所以，暂停现在的工作，出去呼吸一下新鲜空气，与朋友交谈，弹吉他等。<br><code>ps: 莫春者，春服既成，冠者五六人，童子六七人，浴乎沂，风乎舞雩，咏而归。------《论语.先进》。</code></p>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207140423_Iku4es_Screenshot.jpeg" alt=""></p>
<h1 id="在空闲时间学习新事物"><a href="#在空闲时间学习新事物" class="headerlink" title="在空闲时间学习新事物"></a>在空闲时间学习新事物</h1><p><code>当人们停止学习时，他们开始退化。</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/sort-for-sf.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sort-for-sf.html" itemprop="url">15行代码为segmentfault增加头条文章排序功能</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T14:00:46+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  102 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有个需求，想看点赞最多的头条，但是页面没有这种按钮。怎么办？自己写吧。</p>
<p>先看效果<br><img src="http://p3alsaatj.bkt.clouddn.com/20180207140139_xwjt2M_Screenshot.jpeg" alt=""></p>
<p>再看代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rows = $(<span class="string">'.news__item'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> key = +$(<span class="keyword">this</span>).find(<span class="string">'.news__item-zan-number'</span>).text();</span><br><span class="line">    $(<span class="keyword">this</span>).data(<span class="string">'key'</span>, key);</span><br><span class="line">&#125;).get();</span><br><span class="line"></span><br><span class="line">rows.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> keyA = $(a).data(<span class="string">'key'</span>);</span><br><span class="line">    <span class="keyword">var</span> keyB = $(b).data(<span class="string">'key'</span>);</span><br><span class="line">    <span class="keyword">if</span>(keyA&lt;keyB)&#123;<span class="keyword">return</span> <span class="number">-1</span>;&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="number">1</span>;&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$.each(rows, <span class="function"><span class="keyword">function</span>(<span class="params">index, row</span>)</span>&#123;</span><br><span class="line">    $(<span class="string">'.news__list'</span>).prepend(row);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/visual-reading-js-code.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/visual-reading-js-code.html" itemprop="url">可视化交互阅读JS源代码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T13:57:25+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  107 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="曾经，你可以能习惯这样阅读javascript"><a href="#曾经，你可以能习惯这样阅读javascript" class="headerlink" title="曾经，你可以能习惯这样阅读javascript"></a>曾经，你可以能习惯这样阅读javascript</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135809_HSz6fD_Screenshot.jpeg" alt=""></p>
<h1 id="现在，你可以用这个姿势阅读"><a href="#现在，你可以用这个姿势阅读" class="headerlink" title="现在，你可以用这个姿势阅读"></a>现在，你可以用这个姿势阅读</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135821_3b9l9c_Screenshot.jpeg" alt=""></p>
<h1 id="怎么做呢"><a href="#怎么做呢" class="headerlink" title="怎么做呢?"></a>怎么做呢?</h1><h2 id="step1"><a href="#step1" class="headerlink" title="step1:"></a>step1:</h2><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g <span class="built_in">lambda</span>-<span class="built_in">view</span></span><br></pre></td></tr></table></figure>
<h2 id="step2"><a href="#step2" class="headerlink" title="step2:"></a>step2:</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 阅读本地代码</span></span><br><span class="line">lv targer.js</span><br><span class="line"></span><br><span class="line"><span class="comment">// 阅读远程代码</span></span><br><span class="line">lv https:<span class="comment">//code.jquery.com/jquery-3.1.1.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 阅读多个代码</span></span><br><span class="line">lv file1<span class="selector-class">.js</span> file2<span class="selector-class">.js</span> file3.js</span><br><span class="line"></span><br><span class="line"><span class="comment">// 阅读所有</span></span><br><span class="line">lv *.js</span><br></pre></td></tr></table></figure>
<h1 id="项目地址：https-github-com-Jianru-Lin-lambda-view"><a href="#项目地址：https-github-com-Jianru-Lin-lambda-view" class="headerlink" title="项目地址：https://github.com/Jianru-Lin/lambda-view"></a>项目地址：<a href="https://github.com/Jianru-Lin/lambda-view" target="_blank" rel="noopener">https://github.com/Jianru-Lin/lambda-view</a></h1><h1 id="欢迎试玩！"><a href="#欢迎试玩！" class="headerlink" title="欢迎试玩！"></a>欢迎试玩！</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/chrome-snippets-collect.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/chrome-snippets-collect.html" itemprop="url">谷歌浏览器： Snippets小程序哪家强？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T13:48:55+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,577 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Snippets是可以在Chrome DevTools的“源”面板中创建和执行的小脚本。 您可以从任何页面访问和运行它们。 当您运行代码段时，它会从当前打开的页面的上下文执行。</p>
</blockquote>
<h1 id="显示所有元素的边框，看页面布局非常方便"><a href="#显示所有元素的边框，看页面布局非常方便" class="headerlink" title="显示所有元素的边框，看页面布局非常方便"></a>显示所有元素的边框，看页面布局非常方便</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135027_4TAe1P_Screenshot.jpeg" alt=""></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[].forEach.call($$(<span class="string">"*"</span>),<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">  a.style.outline=<span class="string">"1px solid #"</span>+(~~(<span class="built_in">Math</span>.random()*(<span class="number">1</span>&lt;&lt;<span class="number">24</span>))).toString(<span class="number">16</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="allcolors-js"><a href="#allcolors-js" class="headerlink" title="allcolors.js"></a>allcolors.js</h1><blockquote>
<p>从页面上的元素中使用的计算样式打印所有颜色。 使用样式化的console.log调用来可视化每种颜色。</p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135046_bfEqm5_Screenshot.jpeg" alt=""><br><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// allcolors.js</span></span><br><span class="line"><span class="comment">// https://github.com/bgrins/devtools-snippets</span></span><br><span class="line"><span class="comment">// Print out CSS colors used in elements on the page.</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Should include colors from elements that have a border color but have a zero width?</span></span><br><span class="line">  <span class="keyword">var</span> includeBorderColorsWithZeroWidth = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> allColors = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> props = [<span class="string">"background-color"</span>, <span class="string">"color"</span>, <span class="string">"border-top-color"</span>, <span class="string">"border-right-color"</span>, <span class="string">"border-bottom-color"</span>, <span class="string">"border-left-color"</span>];</span><br><span class="line">  <span class="keyword">var</span> skipColors = &#123;</span><br><span class="line">    <span class="string">"rgb(0, 0, 0)"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"rgba(0, 0, 0, 0)"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"rgb(255, 255, 255)"</span>: <span class="number">1</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  [].forEach.call(<span class="built_in">document</span>.querySelectorAll(<span class="string">"*"</span>), <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nodeColors = &#123;&#125;;</span><br><span class="line">    props.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">prop</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> <span class="built_in">color</span> = <span class="built_in">window</span>.getComputedStyle(node, <span class="literal">null</span>).getPropertyValue(prop),</span><br><span class="line">        thisIsABorderProperty = (prop.indexOf(<span class="string">"border"</span>) != <span class="number">-1</span>),</span><br><span class="line">        notBorderZero = thisIsABorderProperty ? <span class="built_in">window</span>.getComputedStyle(node, <span class="literal">null</span>).getPropertyValue(prop.replace(<span class="string">"color"</span>, <span class="string">"width"</span>)) !== <span class="string">"0px"</span> : <span class="literal">true</span>,</span><br><span class="line">        colorConditionsMet;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (includeBorderColorsWithZeroWidth) &#123;</span><br><span class="line">        colorConditionsMet = <span class="built_in">color</span> &amp;&amp; !skipColors[<span class="built_in">color</span>];</span><br><span class="line">      &#125; <span class="title">else</span> &#123;</span><br><span class="line">        colorConditionsMet = <span class="built_in">color</span> &amp;&amp; !skipColors[<span class="built_in">color</span>] &amp;&amp; notBorderZero;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (colorConditionsMet) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!allColors[<span class="built_in">color</span>]) &#123;</span><br><span class="line">          allColors[<span class="built_in">color</span>] = &#123;</span><br><span class="line">            <span class="attribute">count</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attribute">nodes</span>: []</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!nodeColors[<span class="built_in">color</span>]) &#123;</span><br><span class="line">          allColors[<span class="built_in">color</span>].count++;</span><br><span class="line">          allColors[<span class="built_in">color</span>].nodes.push(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        nodeColors[<span class="built_in">color</span>] = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">rgbTextToRgbArray</span>(<span class="params">rgbText</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> rgbText.replace(<span class="regexp">/\s/g</span>, <span class="string">""</span>).match(<span class="regexp">/\d+,\d+,\d+/</span>)[<span class="number">0</span>].split(<span class="string">","</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">parseInt</span>(num, <span class="number">10</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">componentToHex</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hex = c.toString(<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> hex.length == <span class="number">1</span> ? <span class="string">"0"</span> + <span class="attribute">hex</span> : hex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">rgbToHex</span>(<span class="params">rgbArray</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = rgbArray[<span class="number">0</span>],</span><br><span class="line">      g = rgbArray[<span class="number">1</span>],</span><br><span class="line">      b = rgbArray[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"#"</span> + componentToHex(r) + componentToHex(g) + componentToHex(b);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> allColorsSorted = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> allColors) &#123;</span><br><span class="line">    <span class="keyword">var</span> rgbArray = rgbTextToRgbArray(i);</span><br><span class="line">    <span class="keyword">var</span> hexValue = rgbToHex(rgbArray);</span><br><span class="line"></span><br><span class="line">    allColorsSorted.push(&#123;</span><br><span class="line">      <span class="attribute">key</span>: i,</span><br><span class="line">      <span class="attribute">value</span>: allColors[i],</span><br><span class="line">      <span class="attribute">hexValue</span>: hexValue</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  allColorsSorted = allColorsSorted.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b.value.count - a.value.count;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> nameStyle = <span class="string">"font-weight:normal;"</span>;</span><br><span class="line">  <span class="keyword">var</span> countStyle = <span class="string">"font-weight:bold;"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">colorStyle</span>(<span class="params">color</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"background:"</span> + <span class="built_in">color</span> + <span class="string">";color:"</span> + <span class="built_in">color</span> + <span class="string">";border:1px solid #333;"</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.group(<span class="string">"Total colors used in elements on the page: "</span> + <span class="built_in">window</span>.location.href + <span class="string">" are "</span> + allColorsSorted.length);</span><br><span class="line">  allColorsSorted.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.groupCollapsed(<span class="string">"%c    %c "</span> + c.key + <span class="string">" "</span> + c.hexValue + <span class="string">" %c("</span> + c.value.count + <span class="string">" times)"</span>,</span><br><span class="line">      colorStyle(c.key), nameStyle, countStyle);</span><br><span class="line">    c.value.nodes.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(node);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.groupEnd();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">console</span>.groupEnd(<span class="string">"All colors used in elements on the page"</span>);</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<h1 id="cachebuster-js"><a href="#cachebuster-js" class="headerlink" title="cachebuster.js"></a>cachebuster.js</h1><blockquote>
<p>通过在href和src属性的末尾添加Date.now（）来覆盖所有链接和（可选）脚本标记。 默认情况下，不执行处理脚本，应将变量process_scripts更改为true以运行这些脚本。</p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135131_CvscRc_Screenshot.jpeg" alt=""></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//Cache Buster</span><br><span class="line">(<span class="name">function</span> ()&#123;</span><br><span class="line">  var rep = /.*\?.*/,</span><br><span class="line">      links = document.getElementsByTagName('link'),</span><br><span class="line">      scripts = document.getElementsByTagName('script'),</span><br><span class="line">      process_scripts = false<span class="comment">;</span></span><br><span class="line">  for (<span class="name">var</span> i=0<span class="comment">;i&lt;links.length;i++)&#123;</span></span><br><span class="line">    var link = links[i],</span><br><span class="line">        href = link.href<span class="comment">;</span></span><br><span class="line">    if(<span class="name">rep</span>.test(<span class="name">href</span>))&#123;</span><br><span class="line">      link.href = href+'&amp;'+Date.now()<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">      link.href = href+'?'+Date.now()<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  if(<span class="name">process_scripts</span>)&#123;</span><br><span class="line">    for (<span class="name">var</span> i=0<span class="comment">;i&lt;scripts.length;i++)&#123;</span></span><br><span class="line">      var script = scripts[i],</span><br><span class="line">          src = script.src<span class="comment">;</span></span><br><span class="line">      if(<span class="name">rep</span>.test(<span class="name">src</span>))&#123;</span><br><span class="line">        script.src = src+'&amp;'+Date.now()<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">      else&#123;</span><br><span class="line">        script.src = src+'?'+Date.now()<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h1 id="console-save-js"><a href="#console-save-js" class="headerlink" title="console-save.js"></a>console-save.js</h1><blockquote>
<p>从控制台将对象保存为.json文件的简单方法包括一个chrome扩展和一个纯文本。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">console</span><span class="selector-class">.save</span>(<span class="selector-tag">data</span>, <span class="selector-attr">[filename]</span>)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135218_BG0kgp_Screenshot.jpeg" alt=""><br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span>(<span class="name">console</span>)&#123;</span><br><span class="line"></span><br><span class="line">    console.save = function(<span class="name">data</span>, filename)&#123;</span><br><span class="line"></span><br><span class="line">        if(<span class="name">!data</span>) &#123;</span><br><span class="line">            console.error(<span class="symbol">'Console.save:</span> No data')</span><br><span class="line">            return<span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(<span class="name">!filename</span>) filename = <span class="symbol">'console.json</span>'</span><br><span class="line"></span><br><span class="line">        if(<span class="name">typeof</span> data === <span class="string">"object"</span>)&#123;</span><br><span class="line">            data = JSON.stringify(<span class="name">data</span>, undefined, <span class="number">4</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        var blob = new Blob([<span class="name">data</span>], &#123;type: <span class="symbol">'text/json</span>'&#125;),</span><br><span class="line">            e    = document.createEvent(<span class="symbol">'MouseEvents</span>'),</span><br><span class="line">            a    = document.createElement(<span class="symbol">'a</span>')</span><br><span class="line"></span><br><span class="line">        a.download = filename</span><br><span class="line">        a.href = window.URL.createObjectURL(<span class="name">blob</span>)</span><br><span class="line">        a.dataset.downloadurl =  [<span class="symbol">'text/json</span>', a.download, a.href].join(<span class="symbol">':</span>')</span><br><span class="line">        e.initMouseEvent(<span class="symbol">'click</span>', true, false, window, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, false, false, false, false, <span class="number">0</span>, null)</span><br><span class="line">        a.dispatchEvent(<span class="name">e</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="name">console</span>)</span><br></pre></td></tr></table></figure></p>
<h1 id="formcontrols-js"><a href="#formcontrols-js" class="headerlink" title="formcontrols.js"></a>formcontrols.js</h1><blockquote>
<p>在一个不错的表中显示所有html表单元素及其值和类型。 在页面上为每个表单添加一个新表</p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135247_mH2FW4_Screenshot.jpeg" alt=""><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// formcontrols.js</span></span><br><span class="line"><span class="comment">// https://github.com/bgrins/devtools-snippets</span></span><br><span class="line"><span class="comment">// Print out forms and their controls</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> forms = <span class="built_in">document</span>.querySelectorAll(<span class="string">"form"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = forms.length; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> tab = [ ];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.group(<span class="string">"HTMLForm quot;"</span> + forms[i].name + <span class="string">"quot;: "</span> + forms[i].action);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Element:"</span>, forms[i], <span class="string">"\nName:    "</span>+forms[i].name+<span class="string">"\nMethod:  "</span>+forms[i].method.toUpperCase()+<span class="string">"\nAction:  "</span>+forms[i].action || <span class="string">"null"</span>);</span><br><span class="line"></span><br><span class="line">    [<span class="string">"input"</span>, <span class="string">"textarea"</span>, <span class="string">"select"</span>].forEach(<span class="function"><span class="keyword">function</span> (<span class="params">control</span>) </span>&#123;</span><br><span class="line">      [].forEach.call(forms[i].querySelectorAll(control), <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</span><br><span class="line">        tab.push(&#123;</span><br><span class="line">          <span class="string">"Element"</span>: node,</span><br><span class="line">          <span class="string">"Type"</span>: node.type,</span><br><span class="line">          <span class="string">"Name"</span>: node.name,</span><br><span class="line">          <span class="string">"Value"</span>: node.value,</span><br><span class="line">          <span class="string">"Pretty Value"</span>: (<span class="built_in">isNaN</span>(node.value) || node.value === <span class="string">""</span> ? node.value : <span class="built_in">parseFloat</span>(node.value))</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.table(tab);</span><br><span class="line">    <span class="built_in">console</span>.groupEnd();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<h1 id="log-globals-js"><a href="#log-globals-js" class="headerlink" title="log-globals.js"></a>log-globals.js</h1><blockquote>
<p>打印全局变量</p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135302_NLgNKa_Screenshot.jpeg" alt=""><br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*</span></span><br><span class="line">	<span class="keyword">log</span>-globals</span><br><span class="line">	<span class="keyword">by</span> Sindre Sorhus</span><br><span class="line">	https:<span class="comment">//github.com/sindresorhus/log-globals</span></span><br><span class="line">	MIT License</span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">(function () &#123;</span><br><span class="line">	'<span class="keyword">use</span> strict';</span><br><span class="line"></span><br><span class="line">	function getIframe() &#123;</span><br><span class="line">		<span class="keyword">var</span> el = document.createElement('iframe');</span><br><span class="line">		el.style.<span class="keyword">display</span> = 'none';</span><br><span class="line">		document.body.appendChild(el);</span><br><span class="line">		<span class="keyword">var</span> <span class="keyword">win</span> = el.contentWindow;</span><br><span class="line">		document.body.removeChild(el);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">win</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function detectGlobals() &#123;</span><br><span class="line">		<span class="keyword">var</span> iframe = getIframe();</span><br><span class="line">		<span class="keyword">var</span> <span class="keyword">ret</span> = Object.create(null);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> <span class="keyword">prop</span> <span class="keyword">in</span> <span class="keyword">window</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!(<span class="keyword">prop</span> <span class="keyword">in</span> iframe)) &#123;</span><br><span class="line">				<span class="keyword">ret</span>[<span class="keyword">prop</span>] = <span class="keyword">window</span>[<span class="keyword">prop</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">ret</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	console.<span class="built_in">log</span>(detectGlobals());</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<h1 id="performance-js"><a href="#performance-js" class="headerlink" title="performance.js"></a>performance.js</h1><blockquote>
<p>打印有关window.performance对象的信息。 使用console.table和分组来组织信息。</p>
</blockquote>
<p><img src="http://p3alsaatj.bkt.clouddn.com/20180207135314_IhE6UI_Screenshot.jpeg" alt=""><br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">// performance.js</span><br><span class="line">// https://github.com/bgrins/devtools-snippets</span><br><span class="line">// Print out window.performance information.</span><br><span class="line">// https://developer.mozilla.org/en-US/docs/Navigation_timing</span><br><span class="line"></span><br><span class="line">(function () &#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">var</span> t = window.performance.timing;</span><br><span class="line">  <span class="built_in">var</span> lt = window.chrome &amp;&amp; window.chrome.loadTimes &amp;&amp; window.chrome.loadTimes();</span><br><span class="line">  <span class="built_in">var</span> timings = [];</span><br><span class="line"></span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Time Until Page Loaded"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.loadEventEnd - t.navigationStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Time Until DOMContentLoaded"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.domContentLoadedEventEnd - t.navigationStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Total Response Time"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.responseEnd - t.requestStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Connection"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.connectEnd - t.connectStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Response"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.responseEnd - t.responseStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Domain Lookup"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.domainLookupEnd - t.domainLookupStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Load Event"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.loadEventEnd - t.loadEventStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"Unload Event"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.unloadEventEnd - t.unloadEventStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">    <span class="built_in">label</span>: <span class="string">"DOMContentLoaded Event"</span>,</span><br><span class="line">    <span class="built_in">time</span>: t.domContentLoadedEventEnd - t.domContentLoadedEventStart + <span class="string">"ms"</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span>(lt) &#123;</span><br><span class="line">    <span class="keyword">if</span>(lt.wasNpnNegotiated) &#123;</span><br><span class="line">      timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">        <span class="built_in">label</span>: <span class="string">"NPN negotiation protocol"</span>,</span><br><span class="line">        <span class="built_in">time</span>: lt.npnNegotiatedProtocol</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">      <span class="built_in">label</span>: <span class="string">"Connection Info"</span>,</span><br><span class="line">      <span class="built_in">time</span>: lt.connectionInfo</span><br><span class="line">    &#125;);</span><br><span class="line">    timings.<span class="built_in">push</span>(&#123;</span><br><span class="line">      <span class="built_in">label</span>: <span class="string">"First paint after Document load"</span>,</span><br><span class="line">      <span class="built_in">time</span>: Math.ceil(lt.firstPaintTime - lt.finishDocumentLoadTime) + <span class="string">"ms"</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">var</span> navigation = window.performance.navigation;</span><br><span class="line">  <span class="built_in">var</span> navigationTypes = &#123; &#125;;</span><br><span class="line">  navigationTypes[navigation.TYPE_NAVIGATENEXT || <span class="number">0</span>] = <span class="string">"Navigation started by clicking on a link, or entering the URL in the user agent's address bar, or form submission."</span>,</span><br><span class="line">  navigationTypes[navigation.TYPE_RELOAD] = <span class="string">"Navigation through the reload operation or the location.reload() method."</span>,</span><br><span class="line">  navigationTypes[navigation.TYPE_BACK_FORWARD] = <span class="string">"Navigation through a history traversal operation."</span>,</span><br><span class="line">  navigationTypes[navigation.TYPE_UNDEFINED] = <span class="string">"Navigation type is undefined."</span>,</span><br><span class="line"></span><br><span class="line">  console.group(<span class="string">"window.performance"</span>);</span><br><span class="line"></span><br><span class="line">  console.<span class="built_in">log</span>(window.performance);</span><br><span class="line"></span><br><span class="line">  console.group(<span class="string">"Navigation Information"</span>);</span><br><span class="line">  console.<span class="built_in">log</span>(navigationTypes[navigation.type]);</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="string">"Number of redirects that have taken place: "</span>, navigation.redirectCount)</span><br><span class="line">  console.groupEnd(<span class="string">"Navigation Information"</span>);</span><br><span class="line"></span><br><span class="line">  console.group(<span class="string">"Timing"</span>);</span><br><span class="line">  console.<span class="built_in">log</span>(window.performance.timing);</span><br><span class="line">  console.table(timings, [<span class="string">"label"</span>, <span class="string">"time"</span>]);</span><br><span class="line">  console.groupEnd(<span class="string">"Timing"</span>);</span><br><span class="line"></span><br><span class="line">  console.groupEnd(<span class="string">"window.performance"</span>);</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<h1 id="更多有意思的："><a href="#更多有意思的：" class="headerlink" title="更多有意思的："></a>更多有意思的：</h1><ul>
<li><a href="http://bgrins.github.io/devtools-snippets/" target="_blank" rel="noopener">http://bgrins.github.io/devtools-snippets/</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/nodejs-log-packages.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/nodejs-log-packages.html" itemprop="url">nodejs 日志插件比较 VS 自定义日志插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T13:46:51+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  727 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="morgan"><a href="#morgan" class="headerlink" title="morgan"></a><a href="https://github.com/expressjs/morgan" target="_blank" rel="noopener">morgan</a></h1><ul>
<li>【优点】morgan配置非常简单</li>
<li>【优点】支持自定义日志格式</li>
<li>【优点】支持日志分机</li>
<li>【优点】支持日志压缩：使用<a href="https://github.com/iccicci/rotating-file-stream" target="_blank" rel="noopener">rotating-file-stream</a></li>
<li>【缺点】无法同时往console和文件中写日志</li>
</ul>
<h1 id="log4js-node"><a href="#log4js-node" class="headerlink" title="log4js-node"></a><a href="https://github.com/nomiddlename/log4js-node" target="_blank" rel="noopener">log4js-node</a></h1><ul>
<li>【优点】配置简单</li>
<li>【优点】支持同时往控制台和文件中写数据</li>
<li>【优点】支持按照时间或文件大小分割文件</li>
<li>【优点】支持文件压缩<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line">, log4js = <span class="built_in">require</span>(<span class="string">'../lib/log4js'</span>);</span><br><span class="line"></span><br><span class="line">log4js.configure(</span><br><span class="line">  &#123;</span><br><span class="line">    appenders: [</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">"file"</span>,</span><br><span class="line">        filename: <span class="string">"important-things.log"</span>,</span><br><span class="line">        maxLogSize: <span class="number">10</span>*<span class="number">1024</span>*<span class="number">1024</span>, <span class="comment">// = 10Mb</span></span><br><span class="line">        numBackups: <span class="number">5</span>, <span class="comment">// keep five backup files</span></span><br><span class="line">        compress: <span class="literal">true</span>, <span class="comment">// compress the backups</span></span><br><span class="line">        encoding: <span class="string">'utf-8'</span>,</span><br><span class="line">        mode: <span class="built_in">parseInt</span>(<span class="string">'0640'</span>, <span class="number">8</span>),</span><br><span class="line">        flags: <span class="string">'w+'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">"dateFile"</span>,</span><br><span class="line">        filename: <span class="string">"more-important-things.log"</span>,</span><br><span class="line">        pattern: <span class="string">"yyyy-MM-dd-hh"</span>,</span><br><span class="line">        compress: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">"stdout"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> logger = log4js.getLogger(<span class="string">'things'</span>);</span><br><span class="line">logger.debug(<span class="string">"This little thing went to market"</span>);</span><br><span class="line">logger.info(<span class="string">"This little thing stayed at home"</span>);</span><br><span class="line">logger.error(<span class="string">"This little thing had roast beef"</span>);</span><br><span class="line">logger.fatal(<span class="string">"This little thing had none"</span>);</span><br><span class="line">logger.trace(<span class="string">"and this little thing went wee, wee, wee, all the way home."</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="winston"><a href="#winston" class="headerlink" title="winston"></a><a href="https://github.com/winstonjs/winston" target="_blank" rel="noopener">winston</a></h1><ul>
<li>没用过，不做评论</li>
</ul>
<h1 id="fluent-logger-node"><a href="#fluent-logger-node" class="headerlink" title="fluent-logger-node"></a><a href="https://github.com/fluent/fluent-logger-node" target="_blank" rel="noopener">fluent-logger-node</a></h1><ul>
<li>往fluntd中写日志，没用过</li>
</ul>
<h1 id="express-winston"><a href="#express-winston" class="headerlink" title="express-winston"></a><a href="https://github.com/bithavoc/express-winston" target="_blank" rel="noopener">express-winston</a></h1><ul>
<li>没用过</li>
</ul>
<h1 id="如何自定义一个日志插件"><a href="#如何自定义一个日志插件" class="headerlink" title="如何自定义一个日志插件"></a>如何自定义一个日志插件</h1><ul>
<li>可以自定义日志结构</li>
<li>日志文件可以用gzip压缩</li>
<li>不影响往console写日志</li>
<li>可以按时间分割日志</li>
<li>支持日志覆盖，最多保留1个月的备份</li>
</ul>
<p>使用<a href="https://github.com/iccicci/rotating-file-stream" target="_blank" rel="noopener">rotating-file-stream</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> rfs = <span class="built_in">require</span>(<span class="string">'rotating-file-stream'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> logDirectory = __dirname;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wpad</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (num &gt; <span class="number">9</span> ? <span class="string">""</span> : <span class="string">"0"</span>) + num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [Wgenerator 创建文件名函数]</span></span><br><span class="line"><span class="comment"> * @Author   Wdd</span></span><br><span class="line"><span class="comment"> * @DateTime 2017-02-22T10:13:39+0800</span></span><br><span class="line"><span class="comment"> * 日志会保留一个月的：因为日志文件名是只使用日期，9月8号的日志就会覆盖8月8号的日志</span></span><br><span class="line"><span class="comment"> * 文件的格式是gzip</span></span><br><span class="line"><span class="comment"> * 文件名例如：22-log.gizp</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wgenerator</span>(<span class="params">time, index</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(! time)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"temp-log.txt.gzip"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"/storage/"</span>+ Wpad(time.getDate()) +<span class="string">"-log.txt.gzip"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> accessLogStream = rfs(Wgenerator, &#123;</span><br><span class="line">    interval: <span class="string">'1d'</span>, <span class="comment">// 周期为1天</span></span><br><span class="line">    path: logDirectory,</span><br><span class="line">    compress: <span class="string">'gzip'</span> ,</span><br><span class="line">    rotationTime:<span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [exports description]</span></span><br><span class="line"><span class="comment"> * @Author   Wdd</span></span><br><span class="line"><span class="comment"> * @DateTime 2017-02-22T10:24:06+0800</span></span><br><span class="line"><span class="comment"> * 使用方式：</span></span><br><span class="line"><span class="comment"> * 1. 安装rotating-file-stream</span></span><br><span class="line"><span class="comment"> * 2. 在根目录下创建一个文件夹，例如logs。然后把access-log.js放进去</span></span><br><span class="line"><span class="comment"> * 3. 在app.js中var mylog = require('./logs/access-log');</span></span><br><span class="line"><span class="comment"> * 4. 在app = express(); 后添加一句 app.use(mylog);</span></span><br><span class="line"><span class="comment"> * 5. 日志文件会自动生成在./logs/storage文件夹下面，当天的日志会保存在暂存的./logs/temp-log.gzip里</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">	req._startTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">	res.once(<span class="string">'finish'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> msg = <span class="string">""</span>;</span><br><span class="line">		<span class="comment">//hostname</span></span><br><span class="line">		msg = process.env.hostname+<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 时间</span></span><br><span class="line">		msg += <span class="keyword">new</span> <span class="built_in">Date</span>()+<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 请求方式</span></span><br><span class="line">		msg += req.method+<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 响应状态码</span></span><br><span class="line">		msg += res.statusCode+<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// sessionId</span></span><br><span class="line">		msg += req.headers.sessionid+<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 响应时长</span></span><br><span class="line">		msg += <span class="keyword">new</span> <span class="built_in">Date</span>() - req._startTime ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 请求路径</span></span><br><span class="line">		msg += <span class="string">" "</span> + req.originalUrl +<span class="string">'\n\r\n\r'</span>;</span><br><span class="line"></span><br><span class="line">		accessLogStream.write(msg);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	next();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/elegant-way-write-ajax-request.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/elegant-way-write-ajax-request.html" itemprop="url">jQuery进阶：用最优雅的方式写ajax请求</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T13:42:36+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  874 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="首先需要一个配置文件"><a href="#首先需要一个配置文件" class="headerlink" title="首先需要一个配置文件"></a>首先需要一个配置文件</h1><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var api = &#123;</span><br><span class="line">	basePath: <span class="string">'http://192.168.200.226:58080'</span>,</span><br><span class="line">	pathList: [</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">name</span>: <span class="string">'agentHeartBeat'</span>,</span><br><span class="line">			<span class="built_in">path</span>:<span class="string">'/api/csta/agent/heartbeat/&#123;&#123;agentId&#125;&#125;/&#123;&#123;type&#125;&#125;/&#123;&#123;something&#125;&#125;'</span>,</span><br><span class="line">			method:<span class="string">'get'</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">name</span>: <span class="string">'setAgentState'</span>,</span><br><span class="line">			<span class="built_in">path</span>: <span class="string">'/api/csta/agent/state'</span>,</span><br><span class="line">			method: <span class="string">'post'</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">name</span>: <span class="string">'getAgents'</span>,</span><br><span class="line">			<span class="built_in">path</span>: <span class="string">'/user/agent/&#123;&#123;query&#125;&#125;'</span>,</span><br><span class="line">			method: <span class="string">'get'</span></span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="然后需要一个方法，把配置文件生成接口"><a href="#然后需要一个方法，把配置文件生成接口" class="headerlink" title="然后需要一个方法，把配置文件生成接口"></a>然后需要一个方法，把配置文件生成接口</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WellApi</span><span class="params">(Config)</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> headers = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> Api = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">Api.pt = Api.prototype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> util = &#123;</span><br><span class="line">	ajax: <span class="function"><span class="keyword">function</span><span class="params">(url, method, payload)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">return</span> $.ajax(&#123;</span><br><span class="line">        	url: url,</span><br><span class="line">        	type: method || <span class="string">"get"</span>,</span><br><span class="line">        	data: JSON.stringify(payload),</span><br><span class="line">        	headers: headers,</span><br><span class="line">        	dataType: <span class="string">"json"</span>,</span><br><span class="line">        	contentType: <span class="string">'application/json; charset=UTF-8'</span></span><br><span class="line">	    &#125;);</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * [render 模板渲染]</span></span><br><span class="line"><span class="comment">	 * 主要用于将 /users/&#123;&#123;userId&#125;&#125; 和&#123;userId: '89898'&#125;转换成/users/89898，和mastache语法差不多，</span></span><br><span class="line"><span class="comment">	 * 当然我们没必要为了这么小的一个功能来引入一个模板库</span></span><br><span class="line"><span class="comment">	 * query字符串可以当做一个参数传递进来</span></span><br><span class="line"><span class="comment">	 * 例如： /users/&#123;&#123;query&#125;&#125;和&#123;query:'?name=jisika&amp;sex=1'&#125;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Author</span>   Wdd</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@DateTime</span> 2017-03-13T19:42:58+0800</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>    &#123;[type]&#125; tpl [description]</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>    &#123;[type]&#125; data [description]</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span>   &#123;[type]&#125; [description]</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	render: <span class="function"><span class="keyword">function</span><span class="params">(tpl, data)</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> re = /&#123;&#123;([^&#125;]+)?&#125;&#125;/;</span><br><span class="line">		<span class="keyword">var</span> match = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(match = re.exec(tpl))&#123;</span><br><span class="line">		    tpl = tpl.replace(match[<span class="number">0</span>],data[match[<span class="number">1</span>]]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> tpl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [setHeader 暴露设置头部信息的方法]</span></span><br><span class="line"><span class="comment"> * 有些方法需要特定的头部信息，例如登录之后才能获取sesssionId,然后访问所有的接口时，必须携带sessionId</span></span><br><span class="line"><span class="comment"> * 才可以访问</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>   Wdd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span> 2017-03-13T10:34:03+0800</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>    &#123;[type]&#125; headers [description]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Api.pt.setHeader = <span class="function"><span class="keyword">function</span><span class="params">(headers)</span></span>&#123;</span><br><span class="line">	headers = headers;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [fire 发送ajax请求，this会绑定到每个接口上]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>   Wdd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span> 2017-03-13T19:42:13+0800</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>    &#123;[type]&#125; pathParm [description]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>    &#123;[type]&#125; payload [description]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>   &#123;[type]&#125; [description]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fire</span><span class="params">(pathParm, payload)</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> url = util.render(this.path, pathParm);</span><br><span class="line">    <span class="keyword">return</span> util.ajax(url, this.method, payload);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [for 遍历所有接口]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>   Wdd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span> 2017-03-13T19:49:33+0800</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>    &#123;[type]&#125; var i [description]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>   &#123;[type]&#125; [description]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; Config.pathList.length; i++)&#123;</span><br><span class="line"></span><br><span class="line">    Api.pt[Config.pathList[i].name] = &#123;</span><br><span class="line">        path: Config.basePath + Config.pathList[i].path,</span><br><span class="line">        method: Config.pathList[i].method,</span><br><span class="line">        fire: fire</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> Api();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="试用一下"><a href="#试用一下" class="headerlink" title="试用一下"></a>试用一下</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"api.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"jquery-ajax.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">	<span class="keyword">var</span> saas = WellApi(api);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">	saas.agentHeartBeat.fire(&#123;agentId: <span class="string">'5001@1011.cc'</span>, type:<span class="string">'a'</span>, something: <span class="string">'test'</span>&#125;)</span></span><br><span class="line"><span class="actionscript">	.done(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'心跳成功'</span>);</span></span><br><span class="line"><span class="undefined">	&#125;)</span></span><br><span class="line"><span class="actionscript">	.fail(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'心跳失败'</span>);</span></span><br><span class="line"><span class="undefined">	&#125;);</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 如果没有参数要渲染到路径上，那个第一个参数可以传空对象</span></span></span><br><span class="line"><span class="actionscript">	saas.setAgentState.fire(&#123;&#125;, &#123;status: <span class="string">'Ready'</span>&#125;)</span></span><br><span class="line"><span class="actionscript">	.done(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'设置成功'</span>);</span></span><br><span class="line"><span class="undefined">	&#125;)</span></span><br><span class="line"><span class="actionscript">	.fail(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'设置失败'</span>);</span></span><br><span class="line"><span class="undefined">	&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h1><p><code>fire(pathParm, payload)</code>中的<code>pathParm</code>是最终会被渲染到请求的路径里面，而paylaod代表请求体。 </p>
<p>例如：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路径这么写</span></span><br><span class="line"><span class="regexp">/api/</span>&#123;&#123;version&#125;&#125;<span class="regexp">/agent/</span>&#123;&#123;id&#125;&#125;/&#123;&#123;somethingElse&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pathParm这样写</span></span><br><span class="line">&#123;<span class="string">version:</span> <span class="number">1</span>, <span class="string">id:</span> <span class="string">'2'</span>, <span class="string">somethingElse:</span> <span class="string">'sss'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最终路径会被渲染成</span></span><br><span class="line"><span class="regexp">/api/</span><span class="number">1</span><span class="regexp">/agent/</span><span class="number">2</span>/sss</span><br></pre></td></tr></table></figure></p>
<p><code>path里面不仅仅可放一个变量的</code>，具体可以参考<a href="https://github.com/janl/mustache.js" target="_blank" rel="noopener">mustache</a>语法，上面代码里的render是以最简单的实现。</p>
<h1 id="优点与扩展"><a href="#优点与扩展" class="headerlink" title="优点与扩展"></a>优点与扩展</h1><ul>
<li>[优点]：类似与promise的回调方式</li>
<li>[优点]：增加一个接口只是需要增加一个配置文件，很方便</li>
<li>[扩展]：当前的ajax 的contentType我只写了json，有兴趣可以扩展其他的数据类型</li>
<li>[缺点]：没有对函数参数进行校验</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/2017-best-js-books.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-best-js-books.html" itemprop="url">2017年 最好的javascript 书籍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T10:19:22+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,227 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>我看过三本，第1本，第二本，第四本。第一本买的的实体书，其他两本看的是电子书。第一本是大名鼎鼎老道写的，书很薄，但是非常经典。javascirpt忍者秘籍是jquery的作者写的，也是非常经典。you dont kown js系列也是非常好。看了收益匪浅。文章是谷歌翻译的，英文好的直接看原文吧。</p>
</blockquote>
<p>原文：<a href="https://reactdom.com/blog/javascript-books" target="_blank" rel="noopener">https://reactdom.com/blog/javascript-books</a></p>
<blockquote>
<p>你不能是一个好的ReactJS，React Native或GraphQL开发人员，如果你没有很好地理解JavaScript。有太多的JavaScript书出来，每月出来更多。那么什么是最好的JavaScript书为你？经过多年的经历，这些是学习JavaScript的最好的JavaScript书。请记住，这些书中的一些可能不是最新的，但概念和基础仍应适用。我们将继续更新这个最好的JavaScript书籍的列表，还有书签，共享和定期检查！</p>
</blockquote>
<h1 id="JavaScript-The-Good-Parts《JavaScript语言精粹》"><a href="#JavaScript-The-Good-Parts《JavaScript语言精粹》" class="headerlink" title="JavaScript: The Good Parts《JavaScript语言精粹》"></a>JavaScript: The Good Parts《JavaScript语言精粹》</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102004_vjixz0_Screenshot.jpeg" alt=""></p>
<p>JavaScript：Douglas Crockford的Good Parts是JavaScript书籍历史中的一个重要版本，是每个JavaScript程序员都需要阅读的一本书。 Douglas Crockford是JSON，JSLint的创建者，并且对JavaScript的开发做出了许多贡献。</p>
<p>JavaScript：The Good Parts侧重于使JavaScript成为一个伟大的面向对象编程语言的想法。这些想法包括函数，对象，语法，符号等。不幸的是，这些好的想法与坏的和彻底的可怕的想法混在一起，如基于全局变量的编程模型。这本书将告诉你如何避免这些坏的部分，并使用好的部分来制作伟大的代码。</p>
<p>JavaScript：Good Parts将告诉你如何创建优雅的代码，而不管你使用JavaScript的方式。如果你为Web开发网站或应用程序，这本书是绝对必须的。你需要编写复杂的接口，做大量的计算和处理JS，就像它是面向对象的语言，这实际上是一个必读。</p>
<h1 id="You-Don’t-Know-JS《你不知道js》"><a href="#You-Don’t-Know-JS《你不知道js》" class="headerlink" title="You Don’t Know JS《你不知道js》"></a>You Don’t Know JS《你不知道js》</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102016_UmVPGO_Screenshot.jpeg" alt=""></p>
<p>你不知道JS通过Kyle Simpson是一个JavaScript系列的书，将显示你的JavaScript知识的差距，然后教你需要了解JavaScript的一切，以弥补这些差距。 Kyle Simpson是最好的JavaScript老师之一。任何认真对待JavaScript的人都应该注意凯尔的所有教义。</p>
<p>你不知道JS书籍处理JavaScript的棘手部分，以帮助你实现真正的JavaScript掌握。这些书的范围相似，涵盖了并不总是被理解的主题。你不知道JS是每个级别的开发人员的完美。这些书在范围上非常具体，这是它的最大优势。</p>
<p>你不知道JS书系列是所有JavaScript程序员的必须，所有的书是伟大的。短书的长度是一件伟大的事情，你可以快速完成，而不失去焦点。你不知道JS带有最高的建议。</p>
<h1 id="JavaScript-The-Definitive-Guide《JavaScript权威指南》"><a href="#JavaScript-The-Definitive-Guide《JavaScript权威指南》" class="headerlink" title="JavaScript: The Definitive Guide《JavaScript权威指南》"></a>JavaScript: The Definitive Guide《JavaScript权威指南》</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102027_1Flhff_Screenshot.jpeg" alt=""></p>
<p>JavaScript：David Flanagan的“绝对指南”是一本书，它肯定是一个非常沉重的标题，绝对是最好的JavaScript书籍之一。 David Flanagan在Mozilla工作，他的大部分时间都在编写编程书。</p>
<p>JavaScript：The Definitive Guide被分为两个部分，分别是讨论和引用。这两个部分中的每一个包含两个部分，核心和客户端。核心章节涵盖了数据类型，函数，类等语言特性。客户端章节涵盖了在浏览器中运行的JavaScript的使用。 JavaScript：The Definitive Guide包括基于作者现实世界经验的准确文档。</p>
<p>JavaScript：The Definitive Guide多年来一直有多个版本和更新。这是很好的理由;这本书总是在改进，作者总是参与新版本（缺乏许多JavaScript书籍的东西）。无论版本是什么，本书的基础和核心以及JavaScript保持不变。</p>
<p>JavaScript：The Definitive Guide是一个关于JavaScript的最终指南，从基础知识开始，一直到高级功能。 JavaScript：The Definitive Guide属于每个程序员的架子，不能被推荐足够。</p>
<h1 id="Secrets-of-the-JavaScript-Ninja《JavaScript忍者秘籍》"><a href="#Secrets-of-the-JavaScript-Ninja《JavaScript忍者秘籍》" class="headerlink" title="Secrets of the JavaScript Ninja《JavaScript忍者秘籍》"></a>Secrets of the JavaScript Ninja《JavaScript忍者秘籍》</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102038_jVjJSH_Screenshot.jpeg" alt=""></p>
<p>JavaScript Ninja的秘密由John Resig，Bear Bibeault＆Josip Maras是一个JavaScript经典，将把你变成一个JavaScript忍者。 John Resig是jQuery库的创建者，Bear Bibeault是一名网络开发人员，Josip Maras是一位博士后研究员。</p>
<p>JavaScript Ninja的秘密由4部分组成。每个部分都集中在几个相关的话题，从基础到高级。包括的一些主题是功能，对象，原型，承诺等。本书有很多有用的摘要和练习。</p>
<p>JavaScript Ninja的秘密使用非常实用的例子清楚地说明每个核心概念和技术。 JavaScript Ninja的秘密还包括API，最佳实践，跨各种浏览器测试等。</p>
<p>JavaScript Ninja的秘密是非常精巧的写作，这是没有什么惊喜，因为作者在JavaScript非常有经验。 JavaScript Ninja的秘密推荐给任何想成为一个JavaScript忍者，这是每个人。</p>
<h1 id="Effective-JavaScript-68-Specific-Ways-to-Harness-the-Power-of-JavaScript"><a href="#Effective-JavaScript-68-Specific-Ways-to-Harness-the-Power-of-JavaScript" class="headerlink" title="Effective JavaScript: 68 Specific Ways to Harness the Power of JavaScript"></a>Effective JavaScript: 68 Specific Ways to Harness the Power of JavaScript</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102048_OqhkNl_Screenshot.jpeg" alt=""></p>
<p>有效的JavaScript：68具体的方法来利用JavaScript的力量David Herman将教会你通过68提示和技巧写更好的JavaScript。 David Herman是Mozilla Research的首席研究员，在Ecma的JavaScript标准化委员会有多年的经验。</p>
<p>有效的JavaScript集中在68个不同的课程与示例，使你写更好的JavaScript。从基础到高级功能的一切都在详细讨论。要成为JavaScript的主人，您必须学习如何避免陷阱，并使用JavaScript的强大功能有效地工作。有效的JavaScript将帮助编写更好和可维护的代码，而不管您的JavaScript体验。</p>
<p>有效的JavaScript涵盖68个JavaScript原则到68个简短的课程，使它成为一个伟大的方式来学习JavaScript。 Effective JavaScript是一本推荐给所有级别的JavaScript程序员的书，不管它们有多忙。</p>
<h1 id="JavaScript-Patterns-Build-Better-Applications-with-Coding-and-Design-Patterns"><a href="#JavaScript-Patterns-Build-Better-Applications-with-Coding-and-Design-Patterns" class="headerlink" title="JavaScript Patterns: Build Better Applications with Coding and Design Patterns"></a>JavaScript Patterns: Build Better Applications with Coding and Design Patterns</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102104_pqt50u_Screenshot.jpeg" alt=""></p>
<p>JavaScript模式：使用编码和设计模式构建更好的应用程序Stoyan Stefanov教你JavaScript编码模式和最佳实践。 Stoyan Stefanov在雅虎工作，是YSlow 2.0的建筑师</p>
<p>JavaScript模式将引导您使用模式和反模式编写JavaScript。讨论了Singleton等经典设计模式，然后展示了如何在JavaScript中使用它们。讨论了编写高质量JavaScript代码和定义函数的不同和适当方法的伟大习惯。本书涵盖了大量的继承和代码重用技术。 JavaScript模式将教你从初学者到高级水平所需的一切。</p>
<p>JavaScript模式在JavaScript的教学模式以及详细的代码示例方面非常出色。这本书展示了你使用它教授的各种技术的优点和缺点。 JavaScript模式是一本关于开发JavaScript应用程序的精心编写的书，应该用作各级JavaScript开发人员的参考。</p>
<h1 id="The-Principles-of-Object-Oriented-JavaScript"><a href="#The-Principles-of-Object-Oriented-JavaScript" class="headerlink" title="The Principles of Object-Oriented JavaScript"></a>The Principles of Object-Oriented JavaScript</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102115_O5ja00_Screenshot.jpeg" alt=""></p>
<p>Nicholas C. Zakas的面向对象JavaScript的原理探讨了JavaScript的面向对象的特性，并揭示了JavaScript如何使用继承和其他关键属性。 Nicholas C. Zakas是一位前端顾问，在他的主页，YUI等上与Yahoo广泛合作。</p>
<p>面向对象的JavaScript的原则遍历所有的方式在JavaScript中使用面向对象的原则。所有讨论的主题，如处理原型，对象，构造函数等。面向对象的JavaScript的原则涵盖了所有提供的解决方案的优点和缺点，同时深入地涵盖了主题。所有级别的JavaScript开发人员都将从阅读本书中获益良多，并编写更高效的代码。</p>
<p>面向对象的JavaScript的原则涵盖JavaScript的面向对象的方面，并且非常好。这本书的长度不算太大，所以它不会压倒你。如果你想使用JavaScript的面向对象的原则，面向对象的JavaScript的原则是为你。</p>
<h1 id="Eloquent-JavaScript-A-Modern-Introduction-to-Programming"><a href="#Eloquent-JavaScript-A-Modern-Introduction-to-Programming" class="headerlink" title="Eloquent JavaScript: A Modern Introduction to Programming"></a>Eloquent JavaScript: A Modern Introduction to Programming</h1><p><img src="http://p3alsaatj.bkt.clouddn.com/20180207102127_poTUgO_Screenshot.jpeg" alt=""></p>
<p>雄辩的JavaScript：Marijn的现代编程介绍Haverbeke是一本关于JavaScript的惊人的书。这肯定是一本雄辩的书.Marijn Haverbeke在开源软件上工作，并创建了CodeMirror和Tern。</p>
<p>雄辩的JavaScript是所有关于编程。这本书专注于编程和所有的编程概念。雄辩的JavaScript是伟大的初学者，因为它假设没有以前的经验，从编程的基础开始。</p>
<p>雄辩的JavaScript使用一个非常集中的路线图，并充满了练习。 Eloquent JavaScript是一本伟大的书，可以启动JavaScript，并推荐给大家。</p>
<p>擅长JavaScript是一个需要是一个好的ReactJS开发人员。无论你在JavaScript中的专业水平，这些书将帮助你成为一个更好的JavaScript开发人员。不仅如此，他们还会让你成为一个更好的ReactJS和前端开发人员。<br>在你完成这些书后，查看ReactJS书籍和最好的React本土书籍。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/68-skills-to-write-better-js-code.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/68-skills-to-write-better-js-code.html" itemprop="url">读书笔记：编写高质量javascript的68个方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T10:17:16+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  663 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>书还没看完。一遍看，一遍写读书笔记。</p>
<p>这本书的序是JavaScript之父Brendan Eich写的，作者是JavaScript标准化委员会专家。可想而知其质量如何。这本书不厚，和《JavaScript语言精粹》差不多厚，约等于4分之一的《JavaScript权威指南》的厚度。绝对值得一看。</p>
<h1 id="本书赞誉"><a href="#本书赞誉" class="headerlink" title="本书赞誉"></a>本书赞誉</h1><p>本书的赞誉有来自Chrome开发主管，有来自JSHint的专家，还有一些行业大咖。</p>
<blockquote>
<p>如果你想成为一名真正的JavaScript开发者, 那么请阅读这本书。就我来说，我多么希望在第一次开始JavaScript编程时就阅读它。—Anton Kovalyov, JSHint开发者</p>
<p>很少有人有机会同大师一起学习他们的手艺。这本书弥补了这种缺陷，其对JavaScript的研究就像随一位时间旅行哲学家回到公园前5世纪与柏拉图一起学习。—Rick Waldron, JavaScript传教士， Bocoup</p>
</blockquote>
<h1 id="让自己习惯JavaScript"><a href="#让自己习惯JavaScript" class="headerlink" title="让自己习惯JavaScript"></a>让自己习惯JavaScript</h1><blockquote>
<p>有些人说不清哪里好，可就是谁也替代不了。</p>
<h2 id="了解你使用的JavaScript的版本"><a href="#了解你使用的JavaScript的版本" class="headerlink" title="了解你使用的JavaScript的版本"></a>了解你使用的JavaScript的版本</h2></blockquote>
<h2 id="理解JavaScript的浮点数"><a href="#理解JavaScript的浮点数" class="headerlink" title="理解JavaScript的浮点数"></a>理解JavaScript的浮点数</h2><h2 id="当心隐式的强制类型转换"><a href="#当心隐式的强制类型转换" class="headerlink" title="当心隐式的强制类型转换"></a>当心隐式的强制类型转换</h2><h2 id="原始类型优于封装对象"><a href="#原始类型优于封装对象" class="headerlink" title="原始类型优于封装对象"></a>原始类型优于封装对象</h2><h2 id="避免对混合类型使用-运算符"><a href="#避免对混合类型使用-运算符" class="headerlink" title="避免对混合类型使用 == 运算符"></a>避免对混合类型使用 == 运算符</h2><h2 id="了解分号插入的局限"><a href="#了解分号插入的局限" class="headerlink" title="了解分号插入的局限"></a>了解分号插入的局限</h2><h2 id="视字符串为16位的代码单元序列"><a href="#视字符串为16位的代码单元序列" class="headerlink" title="视字符串为16位的代码单元序列"></a>视字符串为16位的代码单元序列</h2><h1 id="变量与作用域"><a href="#变量与作用域" class="headerlink" title="变量与作用域"></a>变量与作用域</h1><blockquote>
<p>作用域对程序员来说就像氧气。它无处不在，甚至，你往往不会去想它。但当它被污染时，你会感觉到窒息。</p>
</blockquote>
<h2 id="尽量少使用全局对象"><a href="#尽量少使用全局对象" class="headerlink" title="尽量少使用全局对象"></a>尽量少使用全局对象</h2><ul>
<li>避免声明全局变量</li>
<li>尽量声明局部变量</li>
<li>避免对全局变量增加属性</li>
</ul>
<h2 id="始终声明局部变量"><a href="#始终声明局部变量" class="headerlink" title="始终声明局部变量"></a>始终声明局部变量</h2><h2 id="避免使用with语句"><a href="#避免使用with语句" class="headerlink" title="避免使用with语句"></a>避免使用with语句</h2><h2 id="熟练使用闭包"><a href="#熟练使用闭包" class="headerlink" title="熟练使用闭包"></a>熟练使用闭包</h2><blockquote>
<p>JavaScript的函数值包含了比调用他们时执行所需要的代码还要更多的信息。而且，JavaScript函数值还在内部存储他们可能会引用的定义在其封闭作用域的变量。那些在其所涵盖的作用域内跟踪变量的函数称为闭包。</p>
</blockquote>
<ul>
<li>JavaScript允许你引用在当前函数以外定义的变量</li>
<li>即使外部函数已经返回，当前函数仍然可以引用外部函数定义的变量</li>
<li>闭包可以更新外部函数的值</li>
</ul>
<h2 id="理解变量声明提升"><a href="#理解变量声明提升" class="headerlink" title="理解变量声明提升"></a>理解变量声明提升</h2><h2 id="使用立即调用表达式创建局部作用域"><a href="#使用立即调用表达式创建局部作用域" class="headerlink" title="使用立即调用表达式创建局部作用域"></a>使用立即调用表达式创建局部作用域</h2><h2 id="当心命名函数表达式笨拙的作用域"><a href="#当心命名函数表达式笨拙的作用域" class="headerlink" title="当心命名函数表达式笨拙的作用域"></a>当心命名函数表达式笨拙的作用域</h2><h2 id="当心局部块函数声明笨拙的作用域"><a href="#当心局部块函数声明笨拙的作用域" class="headerlink" title="当心局部块函数声明笨拙的作用域"></a>当心局部块函数声明笨拙的作用域</h2><h2 id="避免使用evel创建局部变量"><a href="#避免使用evel创建局部变量" class="headerlink" title="避免使用evel创建局部变量"></a>避免使用evel创建局部变量</h2><h2 id="间接调用eval函数函数优于直接调用"><a href="#间接调用eval函数函数优于直接调用" class="headerlink" title="间接调用eval函数函数优于直接调用"></a>间接调用eval函数函数优于直接调用</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/js-high-skills.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/js-high-skills.html" itemprop="url">JavaScript 高级技巧</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T10:14:56+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,006 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安全类型检测"><a href="#安全类型检测" class="headerlink" title="安全类型检测"></a>安全类型检测</h2><ul>
<li>javascript内置类型检测并不可靠</li>
<li>safari某些版本（&lt;4）typeof正则表达式返回为function</li>
</ul>
<p>建议使用Object.prototype.toString.call()方法检测数据类型<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) === <span class="string">"[object Array]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFunction</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) === <span class="string">"[object Function]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isRegExp</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) === <span class="string">"[object RegExp]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNativeJSON</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.JSON &amp;&amp; <span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">JSON</span>) === <span class="string">"[object JSON]"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>对于ie中一COM对象形式实现的任何函数，isFunction都返回false，因为他们并非原生的javascript函数。</code></p>
<p><strong>在web开发中，能够区分原生与非原生的对象非常重要。只有这样才能确切知道某个对象是否有哪些功能</strong></p>
<p>以上所有的正确性的前提是：Object.prototype.toString没有被修改过</p>
<h2 id="作用域安全的构造函数"><a href="#作用域安全的构造函数" class="headerlink" title="作用域安全的构造函数"></a>作用域安全的构造函数</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span><span class="params">(name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用new来创建一个对象</span></span><br><span class="line"><span class="keyword">var</span> one = <span class="keyword">new</span> Person(<span class="string">'wdd'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接调用构造函数</span></span><br><span class="line">Person();</span><br></pre></td></tr></table></figure>
<p>由于this是运行时分配的，如果你使用new来操作，this指向的就是one。如果直接调用构造函数，那么this会指向全局对象window,然后你的代码就会覆盖window的原生name。如果有其他地方使用过window.name, 那么你的函数将会埋下一个深藏的bug。</p>
<p>==那么，如何才能创建一个作用域安全的构造函数？==<br>方法1<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span><span class="params">(name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span> <span class="keyword">instanceof</span> Person)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Person(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="惰性载入函数"><a href="#惰性载入函数" class="headerlink" title="惰性载入函数"></a>惰性载入函数</h1><p>假设有一个方法X，在A类浏览器里叫A,在b类浏览器里叫B,有些浏览器并没有这个方法,你想实现一个跨浏览器的方法。</p>
<p>惰性载入函数的思想是：<code>在函数内部改变函数自身的执行逻辑</code></p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">X</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span>(A)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">A</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(B)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">B</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">Error</span>(<span class="string">'no A or B'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>换一种写法<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">X</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span>(A)&#123;</span><br><span class="line">        X = <span class="function"><span class="keyword">function</span></span>()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">A</span>();</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(B)&#123;</span><br><span class="line">            X = <span class="function"><span class="keyword">function</span></span>()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">B</span>();</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">Error</span>(<span class="string">'no A or B'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">X</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="防篡改对象"><a href="#防篡改对象" class="headerlink" title="防篡改对象"></a>防篡改对象</h1><h2 id="不可扩展对象-Object-preventExtensions"><a href="#不可扩展对象-Object-preventExtensions" class="headerlink" title="不可扩展对象 Object.preventExtensions"></a>不可扩展对象 Object.preventExtensions</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下面代码在谷歌浏览器中执行</span></span><br><span class="line">&gt; <span class="keyword">var</span> person = &#123;<span class="attr">name</span>: <span class="string">'wdd'</span>&#125;;</span><br><span class="line"><span class="literal">undefined</span></span><br><span class="line">&gt; <span class="built_in">Object</span>.preventExtensions(person);</span><br><span class="line"><span class="built_in">Object</span> &#123;<span class="attr">name</span>: <span class="string">"wdd"</span>&#125;</span><br><span class="line">&gt; person.age = <span class="number">10</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line">&gt; person</span><br><span class="line"><span class="built_in">Object</span> &#123;<span class="attr">name</span>: <span class="string">"wdd"</span>&#125;</span><br><span class="line">&gt; <span class="built_in">Object</span>.isExtensible(person)</span><br><span class="line"><span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="密封对象Object-seal"><a href="#密封对象Object-seal" class="headerlink" title="密封对象Object.seal"></a>密封对象Object.seal</h2><p>密封对象不可扩展，并且不能删除对象的属性或者方法。但是属性值可以修改。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> var one = &#123;name: <span class="string">'hihi'</span>&#125;</span></span><br><span class="line">undefined</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Object.seal(one)</span></span><br><span class="line">Object &#123;name: "hihi"&#125;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> one.age = 12</span></span><br><span class="line">12</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> one</span></span><br><span class="line">Object &#123;name: "hihi"&#125;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> delete one.name</span></span><br><span class="line">false</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> one</span></span><br><span class="line">Object &#123;name: "hihi"&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="冻结对象-Object-freeze"><a href="#冻结对象-Object-freeze" class="headerlink" title="冻结对象 Object.freeze"></a>冻结对象 Object.freeze</h2><p>最严格的防篡改就是冻结对象。对象不可扩展，而且密封，不能修改。只能访问。</p>
<h1 id="高级定时器"><a href="#高级定时器" class="headerlink" title="高级定时器"></a>高级定时器</h1><h2 id="函数节流"><a href="#函数节流" class="headerlink" title="函数节流"></a>函数节流</h2><p>函数节流的思想是：<code>某些代码不可以没有间断的连续重复执行</code><br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> processor = &#123;</span><br><span class="line">	timeoutId: <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 实际进行处理的方法</span></span><br><span class="line">	performProcessing: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">		...</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化调用方法</span></span><br><span class="line">	process: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">		clearTimeout(<span class="keyword">this</span>.timeoutId);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">this</span>.timeoutId = setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">			that.performProcessing();</span><br><span class="line">		&#125;, <span class="number">100</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 尝试开始执行</span></span><br><span class="line">processor.process();</span><br></pre></td></tr></table></figure></p>
<h2 id="中央定时器"><a href="#中央定时器" class="headerlink" title="中央定时器"></a>中央定时器</h2><p>页面如果有十个区域要动态显示当前时间，一般来说，可以用10个定时来实现。其实一个中央定时器就可以搞定。</p>
<p>中央定时器动画 demo地址：<a href="http://wangduanduan.coding.me/my-all-demos/ninja/center-time-control.html" target="_blank" rel="noopener">http://wangduanduan.coding.me/my-all-demos/ninja/center-time-control.html</a></p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timers = &#123;</span><br><span class="line">		timerId: <span class="number">0</span>,</span><br><span class="line">		timers: [],</span><br><span class="line">		add: <span class="function"><span class="keyword">function</span><span class="params">(fn)</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.timers.push(fn);</span><br><span class="line">		&#125;,</span><br><span class="line">		start: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">this</span>.timerId)&#123;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			(<span class="function"><span class="keyword">function</span> <span class="title">runNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(timers.timers.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; timers.timers.length ; i++)&#123;</span><br><span class="line">						<span class="keyword">if</span>(timers.timers[i]() === <span class="literal">false</span>)&#123;</span><br><span class="line">							timers.timers.splice(i, <span class="number">1</span>);</span><br><span class="line">							i--;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					timers.timerId = setTimeout(runNext, <span class="number">16</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)();</span><br><span class="line">		&#125;,</span><br><span class="line">		stop: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">			clearTimeout(timers.timerId);</span><br><span class="line">			<span class="keyword">this</span>.timerId = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>
<p>参考书籍：<br>《javascript高级程序设计》<br>《javascript忍者秘籍》</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wdd.js.org/how-to-use-apply.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王端端">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洞香春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/how-to-use-apply.html" itemprop="url">从一个小场景学会使用 apply方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T10:12:36+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  243 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><ul>
<li>需要自定义一个log方法，这个方法可以像原生的console.log一样</li>
<li>在开发环境我希望调用这个log会输出日志信息，生产环境我希望即使调用了这个方法，也不会输出日志信息。</li>
</ul>
<h1 id="实现这个log"><a href="#实现这个log" class="headerlink" title="实现这个log"></a>实现这个log</h1><ul>
<li>可能要使用apply或者call方法</li>
<li>log的参数个数和类型都是不固定的</li>
<li>call的参数个数是固定的，要排除它</li>
<li>apply的参数是需要一个<code>数组</code>，这个合适，可以使用<code>arguments</code>来当做数组传递</li>
</ul>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyLog = &#123;</span><br><span class="line">    silent: <span class="literal">false</span>,</span><br><span class="line">    log: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.silent)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="试用"><a href="#试用" class="headerlink" title="试用"></a>试用</h1><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; MyLog.log(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>, '<span class="number">4545</span>');</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="string">"4545"</span></span><br><span class="line">undefined</span><br><span class="line"></span><br><span class="line">&gt; MyLog.silent = true</span><br><span class="line">true</span><br><span class="line"></span><br><span class="line">&gt; MyLog.log(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>, '<span class="number">4545</span>');</span><br><span class="line">undefined</span><br></pre></td></tr></table></figure>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><ul>
<li>不要随处使用console.log，因为这样当你不需要日志输出的时候，你就要到处填坑了</li>
<li>不要使用alert，这个很烦人</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://p3alsaatj.bkt.clouddn.com/20180129093544_I5Jscb_IMG_1402.jpeg"
                alt="王端端" />
            
              <p class="site-author-name" itemprop="name">王端端</p>
              <p class="site-description motion-element" itemprop="description">前端，后端，炒菜，摄影，读书，收集工具</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">52</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/wangduanduan" rel="external nofollow" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1779706607@qq.com" rel="external nofollow" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://segmentfault.com/u/177970" rel="external nofollow" target="_blank" title="segmentfault">
                      
                        <i class="fa fa-fw fa-globe"></i>segmentfault</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王端端</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
